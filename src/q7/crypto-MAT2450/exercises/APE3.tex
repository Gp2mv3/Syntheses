\section{}
\subsection{}
\begin{solution}
  \begin{enumerate}
    \item
      To have $m^{ed} \equiv m \pmod{N}$,
      it is sufficient to have $ed \equiv 1 \pmod{\varphi(N)}$.
      To have this, we need $e$ relatively prime to $\varphi(N)$.

      $\varphi(N) = (7-1)(11-1) = 60 = 2^235$
      so the smallest $e$ we can take is $7$.
    \item
      To find $d$ such that $ed \equiv 1 \pmod{60}$ we
      can use the extended Euclidean algorithm \footnote{A good explaination can be found at \url{https://www.youtube.com/watch?v=fz1vxq5ts5I}}

      \begin{align*}
        60 & = 8 \cdot 7 + 4\\
        7 & = 1 \cdot 4 + 3\\
        4 & = 1 \cdot 3 + 1
      \end{align*}
      so

      \begin{align*}
        1 & = 4 - 1 \cdot 3\\
          & = 2 \cdot 4 - 1 \cdot 7\\
          & = 2 \cdot 60 - 17 \cdot 7.
      \end{align*}
      We can take $-17 \equiv 43 \pmod{60}$ for $d$.
    \item
      We have

      \begin{align*}
        c & \equiv 75^7 \pmod{77}\\
          & \equiv (-2)^7 \pmod{77}\\
          & \equiv -128 \pmod{77}\\
          & \equiv 26 \pmod{77}.
      \end{align*}
    \item
      Let's just verify it modulo $7$ and $11$ which is equivalent
      according to the CRT

      \begin{align*}
        c^{43} & \equiv 26^{43} \pmod{7}\\
               & \equiv (-2)^{7 \cdot \varphi(7) + 1} \pmod{7}\\
               & \equiv -2 \pmod{7}\\
               & \equiv 75 \pmod{7}
      \end{align*}
      and

      \begin{align*}
        c^{43} & \equiv 26^{43} \pmod{11}\\
               & \equiv 4^{4 \cdot \varphi(11) + 3} \pmod{11}\\
               & \equiv 4^{3} \pmod{11}\\
               & \equiv 64 \pmod{11}\\
               & \equiv -2 \pmod{11}\\
               & \equiv 75 \pmod{11}.
      \end{align*}
  \end{enumerate}
\end{solution}

\subsection{}
\begin{solution}
  \begin{enumerate}
    \item
      \begin{enumerate}
        \item
          $\epsilon_7$ should be a multiple of $11$ so there is a $y$ such
          that $\epsilon_7 = 11y$.
          So we have

          \begin{align*}
            11y & \equiv 1 \pmod{7}\\
              y & \equiv (11)^{-1} \pmod{7}\\
                & \equiv 2 \pmod{7}
          \end{align*}
          which gives $\epsilon_7 \equiv 22 \pmod{77}$.
        \item
          $\epsilon_{11}$ should be a multiple of $7$ so there is a $y$ such
          that $\epsilon_{11} = 7y$.
          So we have

          \begin{align*}
            7y & \equiv 1 \pmod{11}\\
             y & \equiv 7^{-1} \pmod{11}\\
               & \equiv 8 \pmod{11}
          \end{align*}
          which gives $\epsilon_{11} \equiv 56 \pmod{77}$.
        \item
          By the superposition principle
          \begin{align*}
            5\epsilon_7 + 9\epsilon_{11} & \equiv 5 \pmod{7}\\
            5\epsilon_7 + 9\epsilon_{11} & \equiv 9 \pmod{11}
          \end{align*}
          so $x \equiv 5 \cdot 22 + 9 \cdot 56 \equiv 75 \pmod{77}$.
        \end{enumerate}
      \item
        We can take $x_p\epsilon_7 + x_q\epsilon_{11}$
        since by the superposition principle
        \begin{align*}
          x_p\epsilon_7 + x_q\epsilon_{11} & \equiv x_p \cdot 1 + x_q \cdot 0 \pmod{7}\\
                                           & \equiv x_p \pmod{7}\\
          x_p\epsilon_7 + x_q\epsilon_{11} & \equiv x_p \cdot 0 + x_q \cdot 1 \pmod{11}\\
                                           & \equiv x_q \pmod{11}.
        \end{align*}
      \item
        We can know that $\epsilon_p = qy$ for some $y$.
        So we have
        \begin{align*}
          qy & \equiv 1 \pmod{p}\\
           y & \equiv q^{-1} \pmod{p}\\
        \end{align*}
        which gives $\epsilon_7 \equiv qq^{-1} \pmod{pq}$
        where the inverse is taken modulo $p$.

        This is the same for $\epsilon_q$.
      \item
        \[ \psi^{-1} : \mathbb{Z}_p \times \mathbb{Z}_q \to \mathbb{Z}_n; (x_p, x_q) \to x_p\epsilon_p + x_q\epsilon_q. \]
    \end{enumerate}
\end{solution}

\subsection{}
\begin{solution}
  \begin{enumerate}
    \item
      It is a subset of $\mathbb{Z}_p^*$ since $0$
      cannot be the square of an element in $\mathbb{Z}_p^*$.

      It is a group since if $x_1$ and $x_2$ are quadratic residues,
      there exists $y_1,y_2$ such that
      \begin{align*}
        y_1^2 & \equiv x_1 \pmod{p}\\
        y_2^2 & \equiv x_2 \pmod{p}
      \end{align*}
      so
      \[ (y_1y_2)^2 \equiv x_1x_2 \pmod{p} \]
      and $x_1x_2$ is also a quadratic residue.
    \item
      Let's show that there is one square root between $0$ and $\frac{p-1}{2}$ and one between $\frac{p-1}{2}+1$ and $p-1$.
      Using a primitive root $g$ of $p$, and $\alpha,\beta$ such that $g^\alpha = a$ and $g^\beta = b$,
      \begin{align*}
        a^2 & \equiv b^2 \pmod{p}\\
        g^{2\alpha} & \equiv g^{2\beta} \pmod{p}\\
        2\alpha & \equiv 2\beta \pmod{p-1}\\
        \alpha & \equiv \beta \pmod{\frac{p-1}{2}}.
      \end{align*}
      Hence the uniqueness of the square root between each half.
      A quadratic residue has therefore either 1 or 2 roots.
      But if $a^2 \equiv x \pmod{p}$, we also have $(-a)^2 \equiv x \pmod{p}$ and $a \not\equiv -a \pmod{p}$ since $p$ is odd and $a \neq 0$.
      As a consequence, it cannot have only 1 root.
    \item
      If all quadratic residues has 2 roots.
      Since there is $p$ roots and $a$ cannot be the root of 2 different quadratic residues,
      there must be $\frac{p-1}{2}$ quadratic residues (since we do not consider 0).
      The probability is therefore $1/2$.
    \item
      If $x$ is a QR, there is $y$ such that $y^2 \equiv x \pmod{p}$.
      We have
      \begin{align*}
        x^{\frac{p+1}{2}}
        & \equiv x^{\frac{p-1}{2}}x \pmod{p}\\
        & \equiv y^{p-1}x \pmod{p}\\
        & \equiv x \pmod{p}
      \end{align*}
      The other one is $-x^{\frac{p+1}{4}}$.
      If both of them is a quadratic residue, then $-1 = \frac{-x^{\frac{p+1}{4}}}{x^{\frac{p+1}{4}}}$ is one too.
      We know that one of its square root is $(-1)^{\frac{p+1}{2}} = 1$ since $\frac{p+1}{2}$ is even which is absurd
      since $1^2 \not\equiv -1 \pmod{p}$.
    \item
      It is obvious that if $0 \leq a < p-1$ is even, $g^a$ is a QR.
      Since only half are QR, $g^a$ cannot be a QR if $a$ is odd.
      $g^a$ is therefore a QR iff $a$ is even.

      $g^{ab}$ is a QR if $a$ or $b$ are even or equivalently
      if $g^a$ or $g^b$ are QR.
      If $g^a$ and $g^b$ are odd, $h_b$ cannot be a QR.
      If it is we are sure that $b = 0$.

      Let build an adversary $\A$ that outputs 1 if $1$ if the parity of
      $ab$ is consistent with the parity of $a$ and $b$ and $0$ otherwise.
      \begin{itemize}
        \item if $b = 0$, we win iff $c$ has a different parity than $ab$, so the probability of winning $1/2$.
        \item if $b = 1$, we win.
      \end{itemize}
      Therefore
      \[ \Pr[\DDH_{\A,\G}(n) = 1] = \frac{1}{2} + \frac{1}{4} = \frac{3}{4}. \]
      DDH is solved since $\frac{1}{4}$ is non-negligible.
  \end{enumerate}
\end{solution}

\subsection{}
\begin{solution}
  \begin{enumerate}
    \item
      We have
      \[ \epsilon_7 + \epsilon_{11} \equiv 78 \equiv 1 \pmod{77} \]
      and
      \[ \varphi(1) = (1,1) = (1,0) + (0,1). \]
      We also have
      \[ \epsilon_7 \cdot \epsilon_{11} \equiv (2 \cdot 11) \cdot (8 \cdot 7) \equiv 16 \cdot 77 \equiv 0 \pmod{77} \]
      and
      \[ \varphi(0) = (0,0) = (1,0) \cdot (0,1). \]
    \item           
      We have: $\epsilon_p = q(q^{-1} \pmod{p}$ and $\epsilon_q = p(p^{-1} \pmod{q}$, so, $\epsilon_p + \epsilon_q = q(q^{-1} \pmod{p}) + p(p^{-1} \pmod{q})$ where p and q are relatively prime.
      

      And also $\epsilon_p + \epsilon_q = q u + p v$ where u and v are the inverses of p (resp q). We have $q u + p v = 1 \pmod{pq}$ (see BÃ©zout theorem).
      We also have $\epsilon_p \epsilon_q = pq(q^{-1} \pmod{p})(p^{-1} \pmod{q}) = 0 \pmod{pq}$. Whe then have a generalization:


      Finally: $\varphi(1) = (1, 1)$ and $\varphi(0) = (0, 0)$.

    \item
      For the sum whe have: $x = k_1 p + x_p$ and $y = k_2 p + yp$, then whe have $x + y = p(k_1 + k_2) + (x_p + y_p)$.


      For the multiplication: $\varphi(x)\varphi(y) = (x_p, x_q)(y_p, y_q) = (x_p y_p, x_qy_q) = ((xy)_p, (xy)_q) = \varphi(xy)$.
  \end{enumerate}


  The decryption can take advantage of it since it knows $p$ and $q$.
\end{solution}

\subsection{}
\begin{solution}
  \begin{enumerate}
    \item
      If $x \in QR(n)$, there is $y$ such that $y^2 \equiv x \pmod{n}$.
      We have seen that $(y_p^2,y_q^2) = \varphi(y)^2 = \varphi(y^2) = \varphi(x)$
      so $x$ is also a QR modulo $p$ and $q$.

      If $x \in QR(p)$ and $x \in QR(q)$, there is $r_1,r_2$ such that
      $r_1^2 \equiv x_p \pmod{p}$ and $r_2^2 \equiv x_q \pmod{q}$.
      We have seen that
      $x = \varphi^{-1}(x_p,x_q) = \varphi^{-1}(r_1^2,r_2^2) = \varphi^{-1}(r_1,r_2)^2$
      so $x \in QR(n)$.

      If $F$ is a injection, it is also a bijection since it maps $QR(n)$ to itself.
      Let's prove that it is an injection.
      If $x^2 \equiv y^2 \pmod{p}$, $x_p^2 \equiv y_p^2 \pmod{p}$ so
      $(x_p-y_p)(x_p+y_p) \equiv 0 \pmod{p}$.
      Since $p$ is prime, we have either
      $(x_p-y_p) \equiv 0 \pmod{p}$
      or
      $(x_p+y_p) \equiv 0 \pmod{p}$
      The second one is impossible as we have seen in the exercise 3 since that would mean that $-1 \in QR(p)$
      which is absurd since $p \equiv 3 \pmod{4}$.
      We have therefore $x_p \equiv y_p \pmod{p}$,
      the same reasoning gives $x_q \equiv y_q \pmod{q}$ so $x \equiv y \pmod{n}$.
    \item
      Half the numbers are in $QR(p)$ and half are in $QR(q)$ so $1/4$ are in $QR(n)$.
      So each elements of $QR(n)$ has 4 roots.
      These are simple obtained by using the CRT on $\pm$ the square root modulo $p$
      and $\pm$ the square root modulo $q$.
      For example, with 36, we have $6$ for both modulo 7 and 11.
      The 4 square roots modulo $n$ are therefore $\varphi^{-1}(\pm 1, \pm 5)$.
      \begin{align*}
        \epsilon_7 + 5\epsilon_{11} & \equiv -6 \pmod{77}\\
        \epsilon_7 - 5\epsilon_{11} & \equiv -27 \pmod{77}\\
        -\epsilon_7 - 5\epsilon_{11} & \equiv 6 \pmod{77}\\
        -\epsilon_7 + 5\epsilon_{11} & \equiv 27 \pmod{77}.
      \end{align*}
      $F^{-1}(36)$ is the one that is in $QR(n)$ so in $QR(p)$ and $QR(q)$.
      We see that $1^2 \equiv 1 \pmod{7}$ and $4^2 \equiv 5 \pmod{16}$ so $F^{-1}(36) = -6$.
    \item
      \begin{enumerate}
        \item
          We would have $n | (x_0-x_1)(x_0+x_1)$.
          However, since $x_0 \not\equiv \pm x_1 \pmod{n}$,
          $n \nmid (x_0-x_1)$ and $n \nmid (x_0 + x_1)$.
          Therefore, $\gcd(x_0-x_1,n)$ cannot $n$ and cannot be 1 either
          since that would mean that $n | (x_0 + x_1)$.
          Therefore $\gcd(x_0-x_1,n)$ is $p$ or $q$.
        \item
          Let's pick a random $x_1$ and run the the preimage algorithm on $x_1^2$.
          If it outputs $x_0 = \pm x_1$, restart over.
          The probability of this working at each iteration is $1/2$ since there is exactly $4$ roots,
          we have $1/2$ chance to pick the one that is not outputted by the algo.
      \end{enumerate}
    \item
      For an input message $m$, take
      \[ c := m^2 \pmod{n}. \]
      For the decryption, since there is 4 roots, a mechanism should be provided for the Decryption to know which one it is.
      This is why RSA is more used in practice while it has the desadvantage of having no proof to be as unbreakable as factoring.

      It is not CPA secure since it is not randomized.
  \end{enumerate}
\end{solution}

\subsection{}
\begin{solution}
  \begin{enumerate}
    \item
      We know that
      \[ e_{eve}d_{eve} \equiv 1 \pmod(N) \]
      so $e_{eve}d_{eve}-1$ is a multiple of $N$.
    \item
      Let's pick a random $g \in \mathbb{Z}_N^*$ different from $\pm 1$.
      Let $k'$ such that $k = k'\phi(N)$.
      We know that $g^k \equiv 1 \pmod{N}$.
      Considering the sequence
      $g^k, g^{k/2}, g^{k/4}, g^{k/8}, \ldots, g^{k/2^{e_1}}$
      where $e_1$ is the exponent of $2$ in the prime decomposition of $k$.
      We know that
      \begin{align*}
        1
        & = (g^{k/2^{e_1}})^{2^{e_1}} \pmod{N}\\
        ((g^{k/2^{e_1}})^{2^{e_1}} - 1) & = 0 \pmod{N}\\
        ((g^{k/2^{e_1}})^{2^{e_1-1}} - 1)((g^{k/2^{e_1}})^{2^{e_1-1}} + 1) & = 0 \pmod{N}
      \end{align*}
      If $g^{k/2^{e_1}} \not\equiv \pm 1 \pmod{N}$,
      $N$ divides neither of the 2 factors and we can get $p$ or $q$
      by computing $\gcd((g^{k/2^{e_1}})^{2^{e_1-1}} - 1, N)$.

      If $g^{k/2^{e_1}} \equiv \pm 1 \pmod{N}$,
      we need to take another $g$ at random.

      Sadly, I have found that this does not necessarily work.
      If $p \equiv q \equiv 3 \pmod{4}$ for example (let's also say $k' = 1$ for simplicity),
      we have
      \begin{align*}
        g^{k} & \equiv 1 \pmod{N}\\
        g^{k/2}
        & \equiv g^{2\frac{p-1}{2}\frac{p-1}{2}} \pmod{N}\\
        & \equiv 1 \pmod{p}\\
        & \equiv 1 \pmod{q}\\
        & \equiv 1 \pmod{N}\\
      \end{align*}
      $g^{k/4}$ cannot be different from $-1$ or $1$ because that would mean that
      we have found another root for $1$ than $\pm 1$ modulo $p$ or $q$.
    \item
      I think I don't understand the question right.
      Charly only sees $N$, $e_{alice}$ and $e_{bob}$
      but $e_{alice}$ and $e_{bob}$ gives him no infomation.
      it is just number relatively prime to $N$,
      we could have computed them just from $N$.
  \end{enumerate}
\end{solution}
