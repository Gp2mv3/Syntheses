\section{Inertia and stability of matrices}
\exo{3}
Show that
\[
V^*(I_n \otimes A^* + A^\top \otimes I_n) V = I_n \otimes A^*_S + A_S^\top \otimes I_n
\]
whose eigenvalues are \(\bar{\lambda}_j + \lambda_i\), \(i = 1, \dots, n, j = 1, \dots, n)\).

\begin{solution}
	Using Exercises~1.6 and~1.15,
	\begin{align*}
	V^* (I_n \otimes A^* + A^\top \otimes I_n) V
	& = ((U^*)^\top \otimes U^*) (I_n \otimes A^* + A^\top \otimes I_n) (U^\top \otimes U)\\
	& = ((U^*)^\top \otimes U^*) (I_n \otimes A^*) (U^\top \otimes U)\\
	& \quad + ((U^*)^\top \otimes U^*) (A^\top \otimes I_n) (U^\top \otimes U)\\
	& = ((U^*)^\top U^\top) \otimes (U^*A^*U) + ((U^*)^\top A^\top U^\top) \otimes (U^*U)\\
	& = I_n \otimes A_S^* + A_S^\top \otimes I_n.
	\end{align*}
	We know that since $U$ is unitary, $U^\top$ is unitary too.
	With the help of Exercise~1.16, we conclude that $U^\top \otimes U$ is unitary.
	Therefore,
	$I_n \otimes A^* + A^\top \otimes I_n$ has the same spectrum as
	$I_n \otimes A_S^* + A_S^\top \otimes I_n$.
	We can now see that
	\begin{align*}
	A_S & =
	\begin{bmatrix}
	\lambda_1 &           &        & 0\\
	\times    & \lambda_2 &        & \\
	\vdots    & \ddots    &        & \\
	\times    & \cdots    & \times & \lambda_n
	\end{bmatrix},\\
	I_n \otimes A_S^* & =
	\begin{bmatrix}
	A_S^* &       &        & 0\\
	& A_S^* &        & \\
	&       & \ddots & \\
	0     &       &        & A_S^*
	\end{bmatrix},\\
	A_S^\top \otimes I_n & =
	\begin{bmatrix}
	\lambda_1 I_n & \times I_n    & \cdots & \times I_n\\
	& \lambda_2 I_n & \ddots & \vdots\\
	&               & \ddots & \times I_n\\
	0             &               &        & \lambda_n I_n
	\end{bmatrix}.
	\end{align*}
	$I_n \otimes A_S^* + A_S^\top \otimes I_n$ is therefore an
	upper diagonal matrix with the $in + j$th element of its
	diagonal being $\bar{\lambda}_j + \lambda_i$.
	Since it is upper diagonal, it is in its Schur form
	and the elements on its diagonal are its eigenvalues.
\end{solution}

\exo{3}
Show that
\[
V^*(A^\top \otimes A^* - I_{n^2}) V = A_S^\top \otimes A_S^* - I_{n^2}
\]
whose eigenvalues are \(\bar{\lambda}_j \lambda_i - 1\), \((i = 1, \dots, n, j = 1, \dots, n)\).

\begin{solution}
	Using Exercises~1.6 and~1.15,
	\begin{align*}
	V^* (A^\top \otimes A^* - I_{n^2}) V
	& = ((U^*)^\top \otimes U^*) (A^\top \otimes A^* - I_{n^2}) (U^\top \otimes U)\\
	& = ((U^*)^\top \otimes U^*) (A^\top \otimes A^*) (U^\top \otimes U)\\
	& \quad - ((U^*)^\top \otimes U^*) (I_n \otimes I_n) (U^\top \otimes U)\\
	& = (((U^*)^\top A^\top U^\top) \otimes (U^*A^*U) - (U^*)^\top U^\top) \otimes (U^*U)\\
	& = A_S^\top \otimes A_S^* - I_{n^2}.
	\end{align*}
	We know that since $U$ is unitary, $U^\top$ is unitary too.
	With the help of Exercise~1.16, we conclude that $U^\top \otimes U$ is unitary.
	Therefore,
	$A^\top \otimes A^* - I_{n^2}$ has the same spectrum as
	$A_S^\top \otimes A_S^* - I_{n^2}$.
	We can now see that
	\begin{align*}
	A_S & =
	\begin{bmatrix}
	\lambda_1 &           &        & 0\\
	\times    & \lambda_2 &        & \\
	\vdots    & \ddots    &        & \\
	\times    & \cdots    & \times & \lambda_n
	\end{bmatrix},\\
	A_S^\top \otimes A_S^* & =
	\begin{bmatrix}
	\lambda_1 A_S^* & \times A_S^*    & \cdots & \times A_S^*\\
	& \lambda_2 A_S^* & \ddots & \vdots\\
	&                 & \ddots & \times A_S^*\\
	0               &                 &        & \lambda_n A_S^*
	\end{bmatrix}.
	\end{align*}
	$A_S^\top \otimes A_S^* - I_{n^2}$ is therefore
	upper diagonal with the $in + j$th element of its
	diagonal being $\bar{\lambda}_j\lambda_i - 1$.
	Since it is upper diagonal, it is in its Schur form
	and the elements on its diagonal are its eigenvalues.
\end{solution}

\exo{2}
Apply these techniques to \emph{Sylvester's equation}
\[
AX + XB = C.
\]

\begin{solution}
	Let $A_S$ be the Schur form of $A$ and $B_S$ the lower Schur
	form of $B$.
	We have unitary $U_A, U_B$ such that
	$A = U_AA_SU_A^*$ and $B = U_BB_SU_B^*$.
	Let's define the dense matrices $\tilde{X}$ and $\tilde{C}$ such that
	$X = U_A\tilde{X}U_B^*$ and $C = U_A\tilde{C}U_B^*$, we have
	\begin{align*}
	(U_AA_SU_A^*)(U_A\tilde{X}U_B^*) + (U_A\tilde{X}U_B^*)(U_BB_SU_B^*)
	& = U_A\tilde{C}U_B^*\\
	U_AA_S\tilde{X}U_B^* + U_A\tilde{X}B_SU_B^* & = U_A\tilde{C}U_B^*\\
	A_S\tilde{X} + \tilde{X}B_S & = \tilde{C}.
	\end{align*}
	Using $\vect(BPA) = (A^\top \otimes B) \vect(P)$, we have
	\begin{align*}
	\vect(A_S\tilde{X} + \tilde{X}B_S) & = \vect(\tilde{C})\\
	\vect(A_S\tilde{X}I_n) + \vect(I_n\tilde{X}B_S) & = \vect(\tilde{C})\\
	(I_n \otimes A_S) \vect(\tilde{X}) + (B_S^\top \otimes I_n) \vect(\tilde{X}) & = \vect(\tilde{C})\\
	(I_n \otimes A_S + B_S^\top \otimes I_n) \vect(\tilde{X}) & = \vect(\tilde{C})
	\end{align*}
	where $(I_n \otimes A_S + B_S^\top \otimes I_n)$ is upper diagonal
	since $A_S$ and $B_S^\top$ are upper diagonal.
\end{solution}