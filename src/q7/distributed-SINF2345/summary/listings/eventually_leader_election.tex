\begin{lstlisting}[caption = eventually leader election, mathescape, captionpos=b]
Indication: <leLeader : $p_i$>

upon event <Init> do
    suspected = $\emptyset$
    leader := $p_n$
    trigger <leLeader | leader>

upon event <suspect | $p_i$> do
    suspected := suspected $\cup$ {$p_i$}

upon event <restore | $p_i$> do
    suspected := suspected \ {$p_i$}

upon exists $p_i$ s.t. r($p_i$) $\subseteq$ suspected $\wedge$ $p_i \notin$ suspected do
    leader := $p_i$
    trigger <leLeader | $p_i$>
\end{lstlisting}
